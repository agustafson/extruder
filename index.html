<html><head><title>extruder: Home</title><meta charset="utf-8" /><meta http-equiv="X-UA-Compatible" content="IE=edge,chrome=1" /><meta name="viewport" content="width=device-width, initial-scale=1.0" /><meta name="author" content="Chris Jansen" /><meta name="description" content="Populate Scala case classes from any data source" /><meta name="og:image" content="/extruder/img/poster.png" /><meta name="og:title" content="extruder: Home" /><meta name="og:site_name" content="extruder" /><meta name="og:url" content="https://janstenpickle.github.io/extruder/" /><meta name="og:type" content="website" /><meta name="og:description" content="Populate Scala case classes from any data source" /><link rel="icon" type="image/png" href="/extruder/img/favicon.png" /><meta name="twitter:title" content="extruder: Home" /><meta name="twitter:image" content="https://janstenpickle.github.io/extruder/img/poster.png" /><meta name="twitter:description" content="Populate Scala case classes from any data source" /><meta name="twitter:card" content="summary_large_image" /><link rel="icon" type="image/png" sizes="16x16" href="/extruder/img/favicon16x16.png" /><link rel="icon" type="image/png" sizes="32x32" href="/extruder/img/favicon32x32.png" /><link rel="stylesheet" href="https://maxcdn.bootstrapcdn.com/bootstrap/3.3.7/css/bootstrap.min.css" /><link rel="stylesheet" href="https://maxcdn.bootstrapcdn.com/font-awesome/4.7.0/css/font-awesome.min.css" /><link rel="stylesheet" href="/extruder/highlight/styles/atom-one-light.css" /><link rel="stylesheet" href="/extruder/css/style.css" /><link rel="stylesheet" href="/extruder/css/palette.css" /><link rel="stylesheet" href="/extruder/css/codemirror.css" /><link rel="stylesheet" href="/extruder/css/override.css" /><link rel="stylesheet" href="https://cdn.rawgit.com/knsv/mermaid/6.0.0/dist/mermaid.css" /></head><body><header id="site-header"><div class="navbar-wrapper"><div class="container"><div class="row"><div class="col-xs-6"><a href="/extruder/" class="brand"><div class="icon-wrapper"><span>extruder</span></div></a></div><div class="col-xs-6"><nav class="text-right"><ul class=""><li><a href="https://github.com/janstenpickle/extruder"><i class="fa fa-github"></i><span class="hidden-xs">GitHub</span></a></li><li><a href="api"><i class="fa fa-file-text"></i><span class="hidden-xs">Documentation</span></a></li></ul></nav></div></div></div></div><div class="jumbotron"><div class="container"><h1 class="text-center">Populate Scala case classes from any data source</h1><h2></h2><p class="text-center"><a href="https://github.com/janstenpickle/extruder" class="btn btn-outline-inverse">View on GitHub</a></p></div></div><div><ul class="horizontalNav">         <li><a class="" href="/extruder/concepts.html">Extruder Concepts</a></li>  <li><a class="" href="/extruder/usage.html">Usage</a></li>  <li><a class="" href="/extruder/decode_encode.html">Decoding and Encoding</a></li>  <li><a class="" href="/extruder/extending.html">Extending an Existing Data Source</a></li>  <li><a class="" href="/extruder/typeclasses.html">Type Classes</a></li>  <li><a class="" href="/extruder/datatypes.html">Data Types</a></li>  <li><a class="" href="/extruder/metrics.html">Metrics</a></li>  <li><a class="" href="/extruder/combining.html">Combining Data Sources</a></li> </ul></div></header><main id="site-main"><section class="use"><div class="container"><div id="content"><div style="text-align:center"><img src="/extruder/img/extruder.svg" /></div>

<h1 id="extruder">Extruder</h1>

<p><a href="http://typelevel.org/projects"><img src="https://img.shields.io/badge/typelevel-incubator-green.svg" alt="Typelevel Incubator" /></a> <a href="https://circleci.com/gh/janstenpickle/extruder/tree/master"><img src="https://circleci.com/gh/janstenpickle/extruder/tree/master.svg?style=shield" alt="CircleCI" /></a> <a href="https://codecov.io/gh/janstenpickle/extruder"><img src="https://codecov.io/gh/janstenpickle/extruder/branch/master/graph/badge.svg" alt="codecov" /></a></p>

<p>This library uses <a href="https://github.com/milessabin/shapeless">Shapeless</a>, <a href="https://github.com/typelevel/cats">Cats</a> and <a href="https://github.com/typelevel/cats-effect">Cats Effect</a> to provide a neat syntax to instantiate Scala case classes from a data source.</p>

<h2 id="quickstart-guide">Quickstart Guide</h2>

<p><a name="quick-start"></a></p>

<h4 id="follow-the-instructions-below-or-try-it-out-in-scastie">Follow the instructions below or <a href="https://scastie.scala-lang.org/janstenpickle/ozr3LrFpRdyDUqXio3RGtA/1">try it out in Scastie!</a></h4>

<p>Add the following to your <code class="highlighter-rouge">build.sbt</code>:</p>
<div class="language-scala highlighter-rouge"><div class="highlight"><pre class="highlight"><code><span class="n">libraryDependencies</span> <span class="o">+=</span> <span class="s">"io.extruder"</span> <span class="o">%%</span> <span class="s">"extruder"</span> <span class="o">%</span> <span class="s">"0.10.0"</span>

<span class="c1">// only if you require support for cats-effect instances
</span><span class="n">libraryDependencies</span> <span class="o">+=</span> <span class="s">"io.extruder"</span> <span class="o">%%</span> <span class="s">"extruder-cats-effect"</span> <span class="o">%</span> <span class="s">"0.10.0"</span>

<span class="c1">// only if you require support for Typesafe config
</span><span class="n">libraryDependencies</span> <span class="o">+=</span> <span class="s">"io.extruder"</span> <span class="o">%%</span> <span class="s">"extruder-typesafe"</span> <span class="o">%</span> <span class="s">"0.10.0"</span>

<span class="c1">// only if you require support for Circe types
</span><span class="n">libraryDependencies</span> <span class="o">+=</span> <span class="s">"io.extruder"</span> <span class="o">%%</span> <span class="s">"extruder-circe"</span> <span class="o">%</span> <span class="s">"0.10.0"</span>

<span class="c1">// only if you require support for Circe YAML
</span><span class="n">libraryDependencies</span> <span class="o">+=</span> <span class="s">"io.extruder"</span> <span class="o">%%</span> <span class="s">"extruder-circe-yaml"</span> <span class="o">%</span> <span class="s">"0.10.0"</span>

<span class="c1">// only if you require support for refined types
</span><span class="n">libraryDependencies</span> <span class="o">+=</span> <span class="s">"io.extruder"</span> <span class="o">%%</span> <span class="s">"extruder-refined"</span> <span class="o">%</span> <span class="s">"0.10.0"</span>

<span class="c1">// only if you require support for AWS config
</span><span class="n">libraryDependencies</span> <span class="o">+=</span> <span class="s">"io.extruder"</span> <span class="o">%%</span> <span class="s">"extruder-aws"</span> <span class="o">%</span> <span class="s">"0.10.0"</span>

<span class="c1">// only if you require support for prometheus encoders
</span><span class="n">libraryDependencies</span> <span class="o">+=</span> <span class="s">"io.extruder"</span> <span class="o">%%</span> <span class="s">"extruder-metrics-prometheus"</span> <span class="o">%</span> <span class="s">"0.10.0"</span>

<span class="c1">// only if you require support for dropwizard encoders
</span><span class="n">libraryDependencies</span> <span class="o">+=</span> <span class="s">"io.extruder"</span> <span class="o">%%</span> <span class="s">"extruder-metrics-dropwizard"</span> <span class="o">%</span> <span class="s">"0.10.0"</span>

<span class="c1">// only if you require support for spectator encoders
</span><span class="n">libraryDependencies</span> <span class="o">+=</span> <span class="s">"io.extruder"</span> <span class="o">%%</span> <span class="s">"extruder-metrics-spectator"</span> <span class="o">%</span> <span class="s">"0.10.0"</span>
</code></pre></div></div>

<p><strong>Rules for resolution are specified in the declaration of the case class itself:</strong></p>

<p>In <code class="highlighter-rouge">ApplicationConfig</code> below <code class="highlighter-rouge">default</code> will be set to <code class="highlighter-rouge">100</code>, <code class="highlighter-rouge">noDefault</code> will cause a validation failure to be logged and <code class="highlighter-rouge">optional</code> will be set to <code class="highlighter-rouge">None</code>, should the data source not contain a value for each parameter.</p>

<p>See the page on <a href="decode_encode.html">decoding and encoding</a> for more information on the different types of <code class="highlighter-rouge">decode</code> and <code class="highlighter-rouge">encode</code> methods.</p>

<div class="language-scala highlighter-rouge"><div class="highlight"><pre class="highlight"><code><span class="k">import</span> <span class="nn">cats.data.EitherT</span>
<span class="k">import</span> <span class="nn">cats.effect.IO</span>
<span class="k">import</span> <span class="nn">extruder.core._</span>
<span class="k">import</span> <span class="nn">extruder.data._</span>
<span class="k">import</span> <span class="nn">extruder.map._</span>

<span class="k">case</span> <span class="k">class</span> <span class="nc">ApplicationConfig</span><span class="o">(</span><span class="n">default</span><span class="k">:</span> <span class="kt">Int</span> <span class="o">=</span> <span class="mi">100</span><span class="o">,</span> <span class="n">noDefault</span><span class="k">:</span> <span class="kt">String</span><span class="o">,</span> <span class="n">optional</span><span class="k">:</span> <span class="kt">Option</span><span class="o">[</span><span class="kt">Double</span><span class="o">])</span>

<span class="k">val</span> <span class="n">config</span><span class="k">:</span> <span class="kt">Map</span><span class="o">[</span><span class="kt">String</span>, <span class="kt">String</span><span class="o">]</span> <span class="k">=</span> <span class="nc">Map</span><span class="o">(</span><span class="s">"applicationconfig.nodefault"</span> <span class="o">-&gt;</span> <span class="s">"extruder"</span><span class="o">)</span>
<span class="k">val</span> <span class="n">applicationConfig</span><span class="k">:</span> <span class="kt">ApplicationConfig</span> <span class="o">=</span> <span class="nc">ApplicationConfig</span><span class="o">(</span><span class="n">noDefault</span> <span class="k">=</span> <span class="s">"extruder"</span><span class="o">,</span> <span class="n">optional</span> <span class="k">=</span> <span class="nc">None</span><span class="o">)</span>

<span class="c1">// Create a type alias for EitherT monad transformer
</span><span class="k">type</span> <span class="kt">EitherTIO</span><span class="o">[</span><span class="kt">A</span><span class="o">]</span> <span class="k">=</span> <span class="nc">EitherT</span><span class="o">[</span><span class="kt">IO</span>, <span class="kt">ValidationErrors</span>, <span class="kt">A</span><span class="o">]</span>

<span class="c1">// Decode from configuration into different target monads
</span><span class="k">val</span> <span class="n">decoded</span><span class="k">:</span> <span class="kt">Either</span><span class="o">[</span><span class="kt">ValidationErrors</span>, <span class="kt">ApplicationConfig</span><span class="o">]</span> <span class="k">=</span> <span class="n">decode</span><span class="o">[</span><span class="kt">ApplicationConfig</span><span class="o">](</span><span class="n">config</span><span class="o">)</span>
<span class="k">val</span> <span class="n">decodedIO</span><span class="k">:</span> <span class="kt">EitherTIO</span><span class="o">[</span><span class="kt">ApplicationConfig</span><span class="o">]</span> <span class="k">=</span> <span class="n">decodeF</span><span class="o">[</span><span class="kt">EitherTIO</span>, <span class="kt">ApplicationConfig</span><span class="o">](</span><span class="n">config</span><span class="o">)</span>

<span class="c1">// Encode to configuration into different target monads
</span><span class="k">val</span> <span class="n">encoded</span><span class="k">:</span> <span class="kt">Map</span><span class="o">[</span><span class="kt">String</span>, <span class="kt">String</span><span class="o">]</span> <span class="k">=</span> <span class="n">encode</span><span class="o">(</span><span class="n">applicationConfig</span><span class="o">)</span>
<span class="k">val</span> <span class="n">encodedIO</span><span class="k">:</span> <span class="kt">EitherTIO</span><span class="o">[</span><span class="kt">Map</span><span class="o">[</span><span class="kt">String</span>, <span class="kt">String</span><span class="o">]]</span> <span class="k">=</span> <span class="n">encodeF</span><span class="o">[</span><span class="kt">EitherTIO</span><span class="o">](</span><span class="n">applicationConfig</span><span class="o">)</span>
</code></pre></div></div>

<p>It is also possible to print parameters as a table, with keys formatted as they would be in the source data:</p>

<div class="highlighter-rouge"><div class="highlight"><pre class="highlight"><code>val params: String = parameters[ApplicationConfig]
println(params)
</code></pre></div></div>
<p>Which outputs the following:</p>
<div class="highlighter-rouge"><div class="highlight"><pre class="highlight"><code>+-----------------------------+----------+--------+---------+------------------+
| Key                         | Required | Type   | Default | Permitted Values |
+-----------------------------+----------+--------+---------+------------------+
| applicationconfig.default   | N        | Int    | 100     |                  |
| applicationconfig.nodefault | Y        | String |         |                  |
| applicationconfig.optional  | N        | Double |         |                  |
+-----------------------------+----------+--------+---------+------------------+
</code></pre></div></div>

<h2 id="motivation">Motivation</h2>

<p>To learn more about <a href="https://github.com/milessabin/shapeless">shapeless</a> having read Dave Gurnell’s excellent introduction: <a href="http://underscore.io/books/shapeless-guide/">“The Type Astronaut’s Guide to Shapeless”</a>.</p>

<p>Try out <a href="https://github.com/zalando/grafter">Grafter</a>. This project complements applications which use <a href="https://github.com/zalando/grafter">Grafter</a> or other dependency injection frameworks and techniques by providing a way of resolving values in case classes from a data source.</p>

<p>Specifically Grafter requires that all configuration be part single case class to be passed to the entry point of the application. Structuring the config in classes like this works well, but leaves the question of how are these classes populated with config?</p>

<p>This is where Extruder comes in, you can load your configuration from a <a href="data_source.html">data source</a> and use it with <a href="https://github.com/zalando/grafter">Grafter</a> for dependency injection.</p>

<h1 id="modules">Modules</h1>

<table>
  <thead>
    <tr>
      <th>Module</th>
      <th>Description</th>
      <th>Download</th>
    </tr>
  </thead>
  <tbody>
    <tr>
      <td><strong>Extruder</strong></td>
      <td>Main module, includes core functionality and basic resolvers.</td>
      <td><a href="https://bintray.com/janstenpickle/extruder/extruder/_latestVersion"> <img src="https://api.bintray.com/packages/janstenpickle/extruder/extruder/images/download.svg" alt="Download" /> </a></td>
    </tr>
    <tr>
      <td><strong>Cats Effect</strong></td>
      <td>Provides Cats Effect <a href="concepts.html#effects">typeclass implementations</a>.</td>
      <td><a href="https://bintray.com/janstenpickle/extruder/extruder-cats-effect/_latestVersion"> <img src="https://api.bintray.com/packages/janstenpickle/extruder/extruder/images/download.svg" alt="Download" /> </a></td>
    </tr>
    <tr>
      <td><strong>Typesafe Config</strong></td>
      <td>Support for resolution from <a href="https://github.com/typesafehub/config">Typesafe Config</a>.</td>
      <td><a href="https://bintray.com/janstenpickle/extruder/extruder-typesafe/_latestVersion"> <img src="https://api.bintray.com/packages/janstenpickle/extruder/extruder/images/download.svg" alt="Download" /> </a></td>
    </tr>
    <tr>
      <td><strong>Circe</strong></td>
      <td>Bridge to <a href="https://circe.github.io/circe/">Circe</a> encoding/decoding.</td>
      <td><a href="https://bintray.com/janstenpickle/extruder/extruder-circe/_latestVersion"> <img src="https://api.bintray.com/packages/janstenpickle/extruder/extruder/images/download.svg" alt="Download" /> </a></td>
    </tr>
    <tr>
      <td><strong>Circe YAML</strong></td>
      <td>Bridge to <a href="https://circe.github.io/circe/">Circe</a> YAML encoding/decoding.</td>
      <td><a href="https://bintray.com/janstenpickle/extruder/extruder-circe/_latestVersion"> <img src="https://api.bintray.com/packages/janstenpickle/extruder/extruder/images/download.svg" alt="Download" /> </a></td>
    </tr>
    <tr>
      <td><strong>Refined</strong></td>
      <td>Support for <a href="https://github.com/fthomas/refined">Refined</a> types.</td>
      <td><a href="https://bintray.com/janstenpickle/extruder/extruder-refined/_latestVersion"> <img src="https://api.bintray.com/packages/janstenpickle/extruder/extruder/images/download.svg" alt="Download" /> </a></td>
    </tr>
    <tr>
      <td><strong>AWS</strong></td>
      <td>Support for <a href="https://aws.amazon.com/sdk-for-java/">AWS</a> types.</td>
      <td><a href="https://bintray.com/janstenpickle/extruder/extruder-aws/_latestVersion"> <img src="https://api.bintray.com/packages/janstenpickle/extruder/extruder/images/download.svg" alt="Download" /> </a></td>
    </tr>
    <tr>
      <td><strong>Prometheus</strong></td>
      <td>Support for encoding data as <a href="https://prometheus.io">Prometheus</a> metrics.</td>
      <td><a href="https://bintray.com/janstenpickle/extruder/extruder-metrics-prometheus/_latestVersion"> <img src="https://api.bintray.com/packages/janstenpickle/extruder/extruder/images/download.svg" alt="Download" /> </a></td>
    </tr>
    <tr>
      <td><strong>Dropwizard</strong></td>
      <td>Support for encoding data as <a href="https://metrics.dropwizard.io">Dropwizard</a> metrics.</td>
      <td><a href="https://bintray.com/janstenpickle/extruder/extruder-metrics-dropwizard/_latestVersion"> <img src="https://api.bintray.com/packages/janstenpickle/extruder/extruder/images/download.svg" alt="Download" /> </a></td>
    </tr>
    <tr>
      <td><strong>Spectator</strong></td>
      <td>Support for encoding data as <a href="https://github.com/Netflix/spectator">Spectator</a> metrics.</td>
      <td><a href="https://bintray.com/janstenpickle/extruder/extruder-metrics-spectator/_latestVersion"> <img src="https://api.bintray.com/packages/janstenpickle/extruder/extruder/images/download.svg" alt="Download" /> </a></td>
    </tr>
  </tbody>
</table>

<h1 id="supported-functionality">Supported Functionality</h1>

<ul>
  <li><a href="usage.html#primitive-types">Parsing of primitive types</a>:
    <ul>
      <li>Char</li>
      <li>String</li>
      <li>Int</li>
      <li>Long</li>
      <li>Double</li>
      <li>Float</li>
      <li>Short</li>
      <li>Byte</li>
      <li>Boolean</li>
      <li>URL</li>
      <li>Duration</li>
      <li>Finite Duration</li>
    </ul>
  </li>
  <li><a href="refined.html">Support for refined types</a></li>
  <li><a href="usage.html#simple-case-class">Case class resolution</a></li>
  <li><a href="usage.html#sealed-type-families">Sealed type member resolution (ADTs)</a></li>
  <li>Resolution from multiple data sources:
    <ul>
      <li><a href="core/src/main/scala/extruder/core/Map.scala">Simple Map (<code class="highlighter-rouge">Map[String, String]</code>)</a></li>
      <li><a href="core/src/main/scala/extruder/core/SystemPropertiesConfig.scala">System Properties</a></li>
      <li><a href="typesafe/src/main/scala/extruder/typesafe/TypesafeConfig.scala">Typesafe Config</a></li>
    </ul>
  </li>
  <li><a href="data_sources.html">Pluggable data backends</a></li>
  <li><a href="extending.html">Addition of more types</a></li>
</ul>

<h1 id="similar-projects">Similar Projects</h1>

<h3 id="pureconfig">PureConfig</h3>
<p><a href="https://github.com/melrief/pureconfig">PureConfig</a> uses a similar technique to create case classes from <a href="https://github.com/typesafehub/config">Typesafe Config</a>.</p>

<ul>
  <li>Extruder supports pluggable backends - does not rely on <a href="https://github.com/typesafehub/config">Typesafe Config</a> by default</li>
  <li>Pureconfig supports time parsing using <code class="highlighter-rouge">java.time</code> which Extruder does not out of the box, a date parsing module may be added in the future, until then <a href="#extending-an-existing-set-of-resolvers">custom data sources may be added</a></li>
  <li>Resolution of Typesafe <code class="highlighter-rouge">ConfigValue</code>, <code class="highlighter-rouge">ConfigObject</code> and <code class="highlighter-rouge">ConfigList</code> is only supported by the Typesafe Config configuration backend, as it is closely tied to Typesafe Config, Pureconfig supports this by default as it is directly tied to Typesafe config</li>
  <li>Pureconfig supports returning <code class="highlighter-rouge">Map[String, String]</code>, for the time being Extruder does not support this</li>
  <li>Extruder supports control of class and parameter name formatting by <a href="#implementing-pathtostring">overriding a method</a>, however Pureconfig supports this via predefined configuration schemes</li>
</ul>

<h1 id="participation">Participation</h1>

<p>This project supports the Typelevel <a href="http://typelevel.org/conduct.html">code of conduct</a> and aims that its channels
(mailing list, Gitter, github, etc.) to be welcoming environments for everyone.</p>

<h1 id="licence">Licence</h1>

<h4 id="mit-license">MIT License</h4>

<p><em>Copyright (c) 2017-2019 Chris Jansen</em></p>

<p>Permission is hereby granted, free of charge, to any person obtaining a copy
of this software and associated documentation files (the “Software”), to deal
in the Software without restriction, including without limitation the rights
to use, copy, modify, merge, publish, distribute, sublicense, and/or sell
copies of the Software, and to permit persons to whom the Software is
furnished to do so, subject to the following conditions:</p>

<p>The above copyright notice and this permission notice shall be included in all
copies or substantial portions of the Software.</p>

<p>THE SOFTWARE IS PROVIDED “AS IS”, WITHOUT WARRANTY OF ANY KIND, EXPRESS OR
IMPLIED, INCLUDING BUT NOT LIMITED TO THE WARRANTIES OF MERCHANTABILITY,
FITNESS FOR A PARTICULAR PURPOSE AND NONINFRINGEMENT. IN NO EVENT SHALL THE
AUTHORS OR COPYRIGHT HOLDERS BE LIABLE FOR ANY CLAIM, DAMAGES OR OTHER
LIABILITY, WHETHER IN AN ACTION OF CONTRACT, TORT OR OTHERWISE, ARISING FROM,
OUT OF OR IN CONNECTION WITH THE SOFTWARE OR THE USE OR OTHER DEALINGS IN THE
SOFTWARE.</p>

</div></div></section><section class="technologies"><div class="container"><div class="row"></div></div></section></main><footer id="site-footer"><div class="container"><div class="row"><div class="col-xs-6"><p>extruder is designed and developed by <a href="https://github.com/janstenpickle/extruder" target="_blank">Chris Jansen</a></p></div><div class="col-xs-6"><p class="text-right"><a href="https://github.com/janstenpickle/extruder"><span class="fa fa-github"></span>View on GitHub</a></p></div></div><div class="row"><div class="col-xs-6"><p>Website built with <a href="https://47deg.github.io/sbt-microsites/" target="_blank">Sbt-microsites</a> - © 2016 <a href="https://www.47deg.com/" target="_blank">47 Degrees</a></p></div></div></div></footer><script src="https://cdnjs.cloudflare.com/ajax/libs/jquery/1.11.3/jquery.min.js"></script><script src="https://cdnjs.cloudflare.com/ajax/libs/twitter-bootstrap/3.3.7/js/bootstrap.min.js"></script><script src="/extruder/highlight/highlight.pack.js"></script><script>hljs.configure({
languages:['scala','java','bash']
});
hljs.initHighlighting();
             </script><script src="https://cdn.rawgit.com/knsv/mermaid/6.0.0/dist/mermaid.min.js"></script></body></html>